/*
 * Server, implementing the Raft consensus algorith
 * 
 * The Raft Consensus Algorithm
 * https://raft.github.io/
 * 
 * author: Eric Dortmans (e.dortmans@fontys.nl)
 */

import Types.dzn;
import ConsensusModule.dzn;
import Timer.dzn;
import Rules.dzn;
import Config.dzn;
import Rpc.dzn;

interface IServer
{
	in void OnLine();
	in void OffLine();
	
	behaviour
	{
		on OnLine: {}
		on OffLine: {}
	}
}

component Server
{
  provides IServer ctrl; 
  requires IRpcClient rpcclient;
  requires IRpcServer rpcserver;
 
  system
  {
  	ConsensusModule consensus;
  	Timer electionTimer;
  	Timer heartbeatTimer;
    Rules rules;
    Config config;
    
    ctrl <=> consensus.ctrl;
    consensus.electionTimer <=> electionTimer.ctrl;
    consensus.heartbeatTimer <=> heartbeatTimer.ctrl;
    consensus.rules <=> rules.ctrl;
    consensus.config <=> config.ctrl;     
    consensus.rpcclient <=> rpcclient;
    consensus.rpcserver <=> rpcserver;
  }
}
 